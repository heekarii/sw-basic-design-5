<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/Assets/Script/Manager/TransitionManager.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Assets/Script/Manager/TransitionManager.cs" />
              <option name="originalContent" value="using UnityEngine;&#10;using UnityEngine.UI;&#10;using UnityEngine.SceneManagement;&#10;&#10;public class TransitionManager : Singleton&lt;TransitionManager&gt;&#10;{&#10;    private Player _player;&#10;    public StationManager CurStationManager;&#10;    private GameObject _lastRepairSource;&#10;    protected override void Awake()&#10;    {&#10;        base.Awake();&#10;#if UNITY_2023_2_OR_NEWER&#10;        _player = UnityEngine.Object.FindFirstObjectByType&lt;Player&gt;();&#10;#else&#10;        _player = FindObjectOfType&lt;Player&gt;();&#10;#endif&#10;    }&#10;&#10;    public void RegisterStationManager(StationManager manager)&#10;    {&#10;        CurStationManager = manager;&#10;        // StationManager 등록 시 마지막으로 EnterRepairStation을 호출한 오브젝트 정보를 전달&#10;        if (_lastRepairSource != null &amp;&amp; CurStationManager != null)&#10;        {&#10;            CurStationManager.SetRepairSource(_lastRepairSource);&#10;        }&#10;    }&#10;    &#10;    // ▣ Map → Repair 이동&#10;    public void EnterRepairStation()&#10;    {&#10;        EnterRepairStation(null);&#10;    }&#10;&#10;    // 호출한 Repair 오브젝트를 전달받아 추적합니다.&#10;    public void EnterRepairStation(GameObject source)&#10;    {&#10;        // 호출 출처를 저장&#10;        _lastRepairSource = source;&#10;&#10;        // 1) Repair_main 로드&#10;        SceneManager.LoadScene(&quot;RepairShopUIscene&quot;, LoadSceneMode.Additive);&#10;        Cursor.visible = true;&#10;        &#10;        // 2) Map_SCENE 비활성화&#10;        if (_player != null)&#10;            _player.EnterStationaryState();&#10;        else&#10;            Debug.LogWarning(&quot;[TransitionManager] EnterRepairStation: Player가 할당되지 않았습니다.&quot;);&#10;        SetSceneActive(&quot;Map_SCENE&quot;, false);&#10;    }&#10;&#10;    // ▣ Repair → 미니게임&#10;    public void StartMiniGame(string gameSceneName)&#10;    {&#10;        SetSceneActive(&quot;RepairShopUIscene&quot;, false);&#10;        SceneManager.LoadScene(gameSceneName, LoadSceneMode.Additive);&#10;    }&#10;&#10;    // ▣ 미니게임 완료 → Repair 복귀&#10;    public void EndMiniGame(string gameSceneName, bool isSuccess)&#10;    {&#10;        // 언로드하고 Repair UI를 활성화&#10;        SceneManager.UnloadSceneAsync(gameSceneName);&#10;        SetSceneActive(&quot;RepairShopUIscene&quot;, true);&#10;&#10;        // 결과를 현재 등록된 StationManager에 전달 (null 검사)&#10;        if (CurStationManager != null)&#10;        {&#10;            CurStationManager.ShowEndingPage(isSuccess);&#10;        }&#10;        else&#10;        {&#10;            Debug.LogWarning(&quot;[TransitionManager] CurStationManager가 없습니다. 미니게임 결과를 전달할 수 없습니다.&quot;);&#10;        }&#10;        // Repair_main은 그대로 있음&#10;    }&#10;&#10;    // ▣ Repair 종료 → Map 복귀&#10;    public void ExitRepairStation()&#10;    {&#10;        SceneManager.UnloadSceneAsync(&quot;RepairShopUIscene&quot;);&#10;        Cursor.visible = false; &#10;        SetSceneActive(&quot;Map_SCENE&quot;, true);&#10;        if (_player != null)&#10;            _player.ExitStationaryState();&#10;        else&#10;            Debug.LogWarning(&quot;[TransitionManager] ExitRepairStation: Player가 할당되지 않았습니다.&quot;);&#10;    }&#10;&#10;    // 씬 활성/비활성화 도우미&#10;    private void SetSceneActive(string sceneName, bool active)&#10;    {&#10;        Scene scene = SceneManager.GetSceneByName(sceneName);&#10;        if (!scene.IsValid()) return;&#10;&#10;        foreach (GameObject obj in scene.GetRootGameObjects())&#10;        {&#10;            obj.SetActive(active);&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="using UnityEngine;&#10;using UnityEngine.UI;&#10;using UnityEngine.SceneManagement;&#10;&#10;public class TransitionManager : Singleton&lt;TransitionManager&gt;&#10;{&#10;    private Player _player;&#10;    public StationManager CurStationManager;&#10;    private Repair _lastRepairSource;&#10;    protected override void Awake()&#10;    {&#10;        base.Awake();&#10;#if UNITY_2023_2_OR_NEWER&#10;        _player = UnityEngine.Object.FindFirstObjectByType&lt;Player&gt;();&#10;#else&#10;        _player = FindObjectOfType&lt;Player&gt;();&#10;#endif&#10;    }&#10;&#10;    public void RegisterStationManager(StationManager manager)&#10;    {&#10;        CurStationManager = manager;&#10;        // StationManager 등록 시 마지막으로 EnterRepairStation을 호출한 오브젝트 정보를 전달&#10;        if (_lastRepairSource != null &amp;&amp; CurStationManager != null)&#10;        {&#10;            CurStationManager.SetRepairSource(_lastRepairSource);&#10;        }&#10;    }&#10;    &#10;    // ▣ Map → Repair 이동&#10;    public void EnterRepairStation()&#10;    {&#10;        EnterRepairStation((Repair)null);&#10;    }&#10;&#10;    // 호출한 Repair 컴포넌트를 전달받아 추적합니다.&#10;    public void EnterRepairStation(Repair source)&#10;    {&#10;        // 호출 출처(Repair 컴포넌트)를 저장&#10;        _lastRepairSource = source;&#10;&#10;        // 1) Repair_main 로드&#10;        SceneManager.LoadScene(&quot;RepairShopUIscene&quot;, LoadSceneMode.Additive);&#10;        Cursor.visible = true;&#10;        &#10;        // 2) Map_SCENE 비활성화&#10;        if (_player != null)&#10;            _player.EnterStationaryState();&#10;        else&#10;            Debug.LogWarning(&quot;[TransitionManager] EnterRepairStation: Player가 할당되지 않았습니다.&quot;);&#10;        SetSceneActive(&quot;Map_SCENE&quot;, false);&#10;    }&#10;&#10;    // ▣ Repair → 미니게임&#10;    public void StartMiniGame(string gameSceneName)&#10;    {&#10;        SetSceneActive(&quot;RepairShopUIscene&quot;, false);&#10;        SceneManager.LoadScene(gameSceneName, LoadSceneMode.Additive);&#10;    }&#10;&#10;    // ▣ 미니게임 완료 → Repair 복귀&#10;    public void EndMiniGame(string gameSceneName, bool isSuccess)&#10;    {&#10;        // 언로드하고 Repair UI를 활성화&#10;        SceneManager.UnloadSceneAsync(gameSceneName);&#10;        SetSceneActive(&quot;RepairShopUIscene&quot;, true);&#10;&#10;        // 결과를 현재 등록된 StationManager에 전달 (null 검사)&#10;        if (CurStationManager != null)&#10;        {&#10;            CurStationManager.ShowEndingPage(isSuccess);&#10;        }&#10;        else&#10;        {&#10;            Debug.LogWarning(&quot;[TransitionManager] CurStationManager가 없습니다. 미니게임 결과를 전달할 수 없습니다.&quot;);&#10;        }&#10;        // Repair_main은 그대로 있음&#10;    }&#10;&#10;    // ▣ Repair 종료 → Map 복귀&#10;    public void ExitRepairStation()&#10;    {&#10;        SceneManager.UnloadSceneAsync(&quot;RepairShopUIscene&quot;);&#10;        Cursor.visible = false; &#10;        SetSceneActive(&quot;Map_SCENE&quot;, true);&#10;        if (_player != null)&#10;            _player.ExitStationaryState();&#10;        else&#10;            Debug.LogWarning(&quot;[TransitionManager] ExitRepairStation: Player가 할당되지 않았습니다.&quot;);&#10;    }&#10;&#10;    // 씬 활성/비활성화 도우미&#10;    private void SetSceneActive(string sceneName, bool active)&#10;    {&#10;        Scene scene = SceneManager.GetSceneByName(sceneName);&#10;        if (!scene.IsValid()) return;&#10;&#10;        foreach (GameObject obj in scene.GetRootGameObjects())&#10;        {&#10;            obj.SetActive(active);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/Assets/Script/Repair.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Assets/Script/Repair.cs" />
              <option name="originalContent" value="using System;&#10;using System.Collections;&#10;using System.Collections.Generic;&#10;using UnityEngine;&#10;using UnityEngine.Serialization;&#10;&#10;public class Repair : MonoBehaviour&#10;{&#10;    private TransitionManager _transitionManager;&#10;    [SerializeField] private bool _isEntered = false;&#10;&#10;    private void Start()&#10;    {&#10;        #if UNITY_2023_2_OR_NEWER&#10;        _transitionManager = UnityEngine.Object.FindFirstObjectByType&lt;TransitionManager&gt;();&#10;        #else&#10;        _transitionManager = FindObjectOfType&lt;TransitionManager&gt;();&#10;        #endif&#10;    }&#10;    &#10;    void OnCollisionEnter(Collision collision)&#10;    {&#10;        Debug.Log(&quot;Collision Detected&quot;);&#10;        if (collision.gameObject.CompareTag(&quot;Player&quot;) &amp;&amp; !_isEntered)&#10;        {&#10;            _transitionManager.EnterRepairStation(this.gameObject);&#10;            _isEntered = true;&#10;        }&#10;    }&#10;    &#10;    public void SetEnter(bool state)&#10;    {&#10;        _isEntered = state;&#10;    }&#10;}" />
              <option name="updatedContent" value="using System;&#10;using System.Collections;&#10;using System.Collections.Generic;&#10;using UnityEngine;&#10;using UnityEngine.Serialization;&#10;&#10;public class Repair : MonoBehaviour&#10;{&#10;    private TransitionManager _transitionManager;&#10;    [SerializeField] private bool _isEntered = false;&#10;&#10;    private void Start()&#10;    {&#10;        #if UNITY_2023_2_OR_NEWER&#10;        _transitionManager = UnityEngine.Object.FindFirstObjectByType&lt;TransitionManager&gt;();&#10;        #else&#10;        _transitionManager = FindObjectOfType&lt;TransitionManager&gt;();&#10;        #endif&#10;    }&#10;    &#10;    void OnCollisionEnter(Collision collision)&#10;    {&#10;        Debug.Log(&quot;Collision Detected&quot;);&#10;        if (collision.gameObject.CompareTag(&quot;Player&quot;) &amp;&amp; !_isEntered)&#10;        {&#10;            _transitionManager.EnterRepairStation(this);&#10;            _isEntered = true;&#10;        }&#10;    }&#10;    &#10;    public void SetEnter(bool state)&#10;    {&#10;        _isEntered = state;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>